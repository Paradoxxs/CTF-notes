Crimestopper 10.10.10.80 HACKTHEBOX 


Nmap: 


PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.25 ((Ubuntu))



Webservice | Burpsuit

Cookie: admin=0 set to 1 to get admin? 

set admin=1 and page http://10.10.10.80/?op=list becomes visable. 


view-source:http://10.10.10.80/?op=upload 
<!-- #59: SQL Injection in Tip Submission - Removed database requirement by changing submit tip to create a file. -->



http://10.10.10.80/?op=view&secretname=whiterose.txt 
Hello, <br /> You guys should really learn to code, one of the GET Parameters is still vulnerable. Most will think it just leads to a Source Code disclosure but there is a chain that provides RCE. <br /> Contact WhiteRose@DarkArmy.htb for more info. 




http://10.10.10.80/uploads/
READ THE SOURCE LUKE



10.10.10.80/?op=../../../../../../../../../etc/passwd
Are you really trying ../../../../../../../../../etc/passwd!? Did we Time Travel? This isn't the 90's

I know there an way to download the file ( to do LFI)

work to get index.php in base64 encoding
http://10.10.10.80/?op=php://filter/convert.base64-encode/resource=index

 and other files just change index to the file you want.
 
 is there an way to control the filename of the uploaded files? 
 
 The function for generating file name.
 function genFilename() {
	return sha1($_SERVER['REMOTE_ADDR'] . $_SERVER['HTTP_USER_AGENT'] . time() . mt_rand());
}

sha1 always produce a hashed message of 40character, of what seems to be random. 
the most logical, it what I somehow need to bypass the genprocess ? 
 
 I now I can maniputlate the submit and tip post varibles
but the problem that remainds is the sha1 that genertate the secretname for the file, it need to be alter to allow uploading a file with the name of my choice

Getting shell ? 

ChOkO hints me at using php wrapper 
max talk about long file

Idea create a file in the upload funktion with php code. and then try load that code in the index.php?op= and see if it get executed. 

here is were my uploaded file are stored on the server. 
It seems like from here code does get executed. 
can execute html and js code. 
http://10.10.10.80/uploads/10.10.14.178/
